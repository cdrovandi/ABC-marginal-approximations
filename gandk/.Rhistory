)
worksheet_number <- "07"
upper_dir <- paste0("ws",worksheet_number)
file_name <- paste0(ws_file_prefix, worksheet_number, ".Rmd")
out_name <- paste0(ws_file_prefix, worksheet_number,".pdf")
ws_dir <- paste(path_to_ws, upper_dir, sep = "/")
# render questions and solutions
render_qands(dir = ws_dir,
rmd_file = file_name,
out_file = out_name,
knitr_params = knitr_params
)
worksheet_number <- "07"
upper_dir <- paste0("ws",worksheet_number)
file_name <- paste0(ws_file_prefix, worksheet_number, ".Rmd")
out_name <- paste0(ws_file_prefix, worksheet_number,".pdf")
ws_dir <- paste(path_to_ws, upper_dir, sep = "/")
# render questions and solutions
render_qands(dir = ws_dir,
rmd_file = file_name,
out_file = out_name,
knitr_params = knitr_params
)
####
worksheet_number <- "07"
upper_dir <- paste0("ws",worksheet_number)
file_name <- paste0(ws_file_prefix, worksheet_number, ".Rmd")
out_name <- paste0(ws_file_prefix, worksheet_number,".pdf")
ws_dir <- paste(path_to_ws, upper_dir, sep = "/")
# render questions and solutions
render_qands(dir = ws_dir,
rmd_file = file_name,
out_file = out_name,
knitr_params = knitr_params
)
worksheet_number <- "07"
upper_dir <- paste0("ws",worksheet_number)
file_name <- paste0(ws_file_prefix, worksheet_number, ".Rmd")
out_name <- paste0(ws_file_prefix, worksheet_number,".pdf")
ws_dir <- paste(path_to_ws, upper_dir, sep = "/")
# render questions and solutions
render_qands(dir = ws_dir,
rmd_file = file_name,
out_file = out_name,
knitr_params = knitr_params
)
worksheet_number <- "07"
upper_dir <- paste0("ws",worksheet_number)
file_name <- paste0(ws_file_prefix, worksheet_number, ".Rmd")
out_name <- paste0(ws_file_prefix, worksheet_number,".pdf")
ws_dir <- paste(path_to_ws, upper_dir, sep = "/")
# render questions and solutions
render_qands(dir = ws_dir,
rmd_file = file_name,
out_file = out_name,
knitr_params = knitr_params
)
worksheet_number <- "07"
upper_dir <- paste0("ws",worksheet_number)
file_name <- paste0(ws_file_prefix, worksheet_number, ".Rmd")
out_name <- paste0(ws_file_prefix, worksheet_number,".pdf")
ws_dir <- paste(path_to_ws, upper_dir, sep = "/")
# render questions and solutions
render_qands(dir = ws_dir,
rmd_file = file_name,
out_file = out_name,
knitr_params = knitr_params
)
75 + 37 + 17 + 14 + 14 + 6 + 11 + 4 + 3 + 3 + 2 + 1 +
=
75 + 37 + 17 + 14 + 14 + 6 + 11 + 4 + 3 + 3 + 2 + 1
2.678 - 1.515
1.515 - 0.3517
#### Compile one file ####
worksheet_number <- "07"
upper_dir <- paste0("ws",worksheet_number)
file_name <- paste0(ws_file_prefix, worksheet_number, ".Rmd")
out_name <- paste0(ws_file_prefix, worksheet_number,".pdf")
ws_dir <- paste(path_to_ws, upper_dir, sep = "/")
# render questions and solutions
render_qands(dir = ws_dir,
rmd_file = file_name,
out_file = out_name,
knitr_params = knitr_params
)
####
#path_to_ws <- "~/code/qut-mxn601-worksheets/"
#path_to_ws <- "~/Dropbox/QUT/MXN601 2020/qut-mxn601-worksheets/"
path_to_ws <- "C:/Users/drovandi/Dropbox (QUT)/1 teaching/MXN601/MXN601 2020/qut-mxn601-worksheets"
#### Render questions and solutions function
render_qands <- function(dir, rmd_file, out_file, knitr_params){
sols_file_name <- paste0("solutions-", out_file)
# temporarily changes working directory so that links in docs are relative, not absolute
withr::with_dir(
new = dir,
code =  {
rmarkdown::render(input = file_name,
output_file = out_file,
params = c(knitr_params, show_solutions = F)
)
# knit worksheet answers
rmarkdown::render(input = file_name,
output_file = sols_file_name,
params = c(knitr_params, show_solutions = T)
)
}
)
}
#### Params - always run ####
knitr_params <- list(
tutor_name = "Chris"
)
ws_file_prefix <- "mxn601-ws-"
####
#### Compile one file ####
worksheet_number <- "07"
upper_dir <- paste0("ws",worksheet_number)
file_name <- paste0(ws_file_prefix, worksheet_number, ".Rmd")
out_name <- paste0(ws_file_prefix, worksheet_number,".pdf")
ws_dir <- paste(path_to_ws, upper_dir, sep = "/")
# render questions and solutions
render_qands(dir = ws_dir,
rmd_file = file_name,
out_file = out_name,
knitr_params = knitr_params
)
####
worksheet_number <- "07"
upper_dir <- paste0("ws",worksheet_number)
file_name <- paste0(ws_file_prefix, worksheet_number, ".Rmd")
out_name <- paste0(ws_file_prefix, worksheet_number,".pdf")
ws_dir <- paste(path_to_ws, upper_dir, sep = "/")
# render questions and solutions
render_qands(dir = ws_dir,
rmd_file = file_name,
out_file = out_name,
knitr_params = knitr_params
)
####
worksheet_number <- "07"
upper_dir <- paste0("ws",worksheet_number)
file_name <- paste0(ws_file_prefix, worksheet_number, ".Rmd")
out_name <- paste0(ws_file_prefix, worksheet_number,".pdf")
ws_dir <- paste(path_to_ws, upper_dir, sep = "/")
# render questions and solutions
render_qands(dir = ws_dir,
rmd_file = file_name,
out_file = out_name,
knitr_params = knitr_params
)
####
install.packages("linl")
install.packages("BSL")
library(BSL)
qnorm(0.01)
980 + 20*2.326348
28597*1.5*0.35
28597*1.5*0.65
?BSL
library(BSL)
?BSL
log(0.05/(1-0.01))
log(0.05)/log(1-0.01)
log(0.1)/log(1-0.01)
log(0.2)/log(1-0.01)
log(0.01)/log(0.99)
log(0.01)/log(0.9)
log(0.01)/log(0.95)
-2^3
-2^4
(-2)^4
3^4
log(6)
log(9)
8^(2/3)
1 - 9/4 + 6 + 8 - 3/2*4 - 1 + 3/2
0^(1/3)
1 - 9/2 + 6 + 8 - 3/2*4 - 1 + 3/2
1/12 + 1/6
60/25^5*(5^11/11 - 2*5^13/(25*13) + 5^15/(25^2*15))
5*(5/7)^0.5
60/25^5*(5^11/11 - 5^13/(25*13))
library(BSL)
install.packages("BSL")
library(BSL)
Rversion()
R.version
library(BSL)
citation("robust")
citation("robustbase")
citation("BSL")
citation("mcmc")
setwd("C:/Users/drovandi/Dropbox/1 Research/ABC Research/Marginal Adjustment/Github Code/ABC-marginal-approximations/gandk")
# Package names
packages <- c("parallel", "gk", "mvtnorm", "MASS")
# Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
install.packages(packages[!installed_packages])
}
# Packages loading
invisible(lapply(packages, library, character.only = TRUE))
source("smc_abc_generic.R")
source("smc_abc_generic_continue.R")
source("auxiliary_functions.R")
# generate observed data
#y = rgk(10000,3,1,2,0.5)
#save(y, file = "data_gandk.RData")
# load the "observed" data
load(file = "data_gandk.RData")
############ SMC ABC with robust summaries ###############
obs_summ = summary_robust(y)
extra_args = list(obs_summ = obs_summ, nobs = 10000, lower = c(0, 0, 0, 0), upper = c(10, 10, 10, 10), return_summ = TRUE)
results = smc_abc_generic(1000,0.5,0.01,prior_sim_trans,prior_eval,distance_robust,extra_args)
save(results, file = "results_robust.RData")
############ SMC ABC with robust summaries pilot run ###############
obs_summ = summary_robust(y)
extra_args = list(obs_summ = obs_summ, nobs = 10000, lower = c(0, 0, 0, 0), upper = c(10, 10, 10, 10), return_summ = TRUE)
results = smc_abc_generic(1000,0.5,0.2,prior_sim_trans,prior_eval,distance_robust,extra_args)
save(results, file = "results_robust_pilot.RData")
############ SMC ABC with first robust summary ###############
obs_summ = summary_robust1(y)
extra_args = list(obs_summ = obs_summ, nobs = 10000, lower = c(0, 0, 0, 0), upper = c(10, 10, 10, 10), return_summ = TRUE)
results = smc_abc_generic(1000,0.5,0.01,prior_sim_trans,prior_eval,distance_robust1,extra_args)
save(results, file = "results_robust1.RData")
############ SMC ABC with second robust summary ###############
obs_summ = summary_robust2(y)
extra_args = list(obs_summ = obs_summ, nobs = 10000, lower = c(0, 0, 0, 0), upper = c(10, 10, 10, 10), return_summ = TRUE)
results = smc_abc_generic(1000,0.5,0.01,prior_sim_trans,prior_eval,distance_robust2,extra_args)
save(results, file = "results_robust2.RData")
############ SMC ABC with third robust summary ###############
obs_summ = summary_robust3(y)
extra_args = list(obs_summ = obs_summ, nobs = 10000, lower = c(0, 0, 0, 0), upper = c(10, 10, 10, 10), return_summ = TRUE)
results = smc_abc_generic(1000,0.5,0.01,prior_sim_trans,prior_eval,distance_robust3,extra_args)
save(results, file = "results_robust3.RData")
############ SMC ABC with fourth robust summary ###############
obs_summ = summary_robust4(y)
extra_args = list(obs_summ = obs_summ, nobs = 10000, lower = c(0, 0, 0, 0), upper = c(10, 10, 10, 10), return_summ = TRUE)
results = smc_abc_generic(1000,0.5,0.01,prior_sim_trans,prior_eval,distance_robust4,extra_args)
save(results, file = "results_robust4.RData")
############ SMC ABC with first robust summary using pilot run ###############
load("results_robust_pilot.RData")
obs_summ_pilot = summary_robust(y)
obs_summ = summary_robust1(y)
dist_pilot = max(results$dist)
extra_args = list(obs_summ = obs_summ, obs_summ_pilot = obs_summ_pilot, dist_pilot = dist_pilot, nobs = 10000, lower = c(0, 0, 0, 0), upper = c(10, 10, 10, 10), return_summ = TRUE)
results = smc_abc_generic_continue(results$theta,as.matrix(results$ssx[,1]),1000,0.5,0.01,prior_sim_trans,prior_eval,distance_robust1,distance_pilot_robust1,extra_args)
save(results, file = "results_robust1_continue.RData")
############ SMC ABC with second robust summary using pilot run ###############
load("results_robust_pilot.RData")
obs_summ_pilot = summary_robust(y)
obs_summ = summary_robust2(y)
dist_pilot = max(results$dist)
extra_args = list(obs_summ = obs_summ, obs_summ_pilot = obs_summ_pilot, dist_pilot = dist_pilot, nobs = 10000, lower = c(0, 0, 0, 0), upper = c(10, 10, 10, 10), return_summ = TRUE)
results = smc_abc_generic_continue(results$theta,as.matrix(results$ssx[,2]),1000,0.5,0.01,prior_sim_trans,prior_eval,distance_robust2,distance_pilot_robust2,extra_args)
save(results, file = "results_robust2_continue.RData")
############ SMC ABC with third robust summary using pilot run ###############
load("results_robust_pilot.RData")
obs_summ_pilot = summary_robust(y)
obs_summ = summary_robust3(y)
dist_pilot = max(results$dist)
extra_args = list(obs_summ = obs_summ, obs_summ_pilot = obs_summ_pilot, dist_pilot = dist_pilot, nobs = 10000, lower = c(0, 0, 0, 0), upper = c(10, 10, 10, 10), return_summ = TRUE)
results = smc_abc_generic_continue(results$theta,as.matrix(results$ssx[,3]),1000,0.5,0.01,prior_sim_trans,prior_eval,distance_robust3,distance_pilot_robust3,extra_args)
save(results, file = "results_robust3_continue.RData")
############ SMC ABC with fourth robust summary using pilot run ###############
load("results_robust_pilot.RData")
obs_summ_pilot = summary_robust(y)
obs_summ = summary_robust4(y)
dist_pilot = max(results$dist)
extra_args = list(obs_summ = obs_summ, obs_summ_pilot = obs_summ_pilot, dist_pilot = dist_pilot, nobs = 10000, lower = c(0, 0, 0, 0), upper = c(10, 10, 10, 10), return_summ = TRUE)
results = smc_abc_generic_continue(results$theta,as.matrix(results$ssx[,4]),1000,0.5,0.01,prior_sim_trans,prior_eval,distance_robust4,distance_pilot_robust4,extra_args)
save(results, file = "results_robust4_continue.RData")
# Package names
packages <- c("ggplot2", "gridExtra", "grid")
# Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
install.packages(packages[!installed_packages])
}
# Packages loading
invisible(lapply(packages, library, character.only = TRUE))
# load libraries
#library(ggplot2)
#library(gridExtra)
#library(grid)
source("auxiliary_functions.R")
# load the "observed" data
load(file = "data_gandk.RData")
obs_summ = summary_robust(y)
true_param = c(3,1,2,0.5)
##################### parameter 1 #####################
load("results_robust.RData")
theta_robust = 10/(1+exp(-results$theta))
theta_robust = data.frame(theta_robust)
theta_robust$method = "all summs"
colnames(theta_robust) = c("a", "b", "g", "k", "method")
load("results_robust_pilot.RData")
theta_robust_pilot = 10/(1+exp(-results$theta))
theta_robust_pilot = data.frame(theta_robust_pilot)
theta_robust_pilot$method = "pilot (all summs)"
colnames(theta_robust_pilot) = c("a", "b", "g", "k", "method")
load("results_robust1.RData")
theta_robust1 = 10/(1+exp(-results$theta))
theta_robust1 = data.frame(theta_robust1)
theta_robust1$method = "summ 1"
colnames(theta_robust1) = c("a", "b", "g", "k", "method")
load("results_robust1_continue.RData")
theta_robust1_continue = 10/(1+exp(-results$theta))
theta_robust1_continue = data.frame(theta_robust1_continue)
theta_robust1_continue$method = "pilot + summ 1"
colnames(theta_robust1_continue) = c("a", "b", "g", "k", "method")
theta = rbind(theta_robust,theta_robust1,theta_robust_pilot,theta_robust1_continue)
p1 = ggplot(data=theta) +
geom_density(aes(x=a, group = method, colour = method, linetype = method), size = 1.5) +
theme(legend.position="none") +
geom_point(aes(x=true_param[1], y=0), colour="black", size = 4) +
xlim(c(2.75,3.25)) + theme(axis.title=element_text(size=16)) + labs(y= "density")
##################### parameter 2 #####################
load("results_robust.RData")
theta_robust = 10/(1+exp(-results$theta))
theta_robust = data.frame(theta_robust)
theta_robust$method = "all summs"
colnames(theta_robust) = c("a", "b", "g", "k", "method")
load("results_robust_pilot.RData")
theta_robust_pilot = 10/(1+exp(-results$theta))
theta_robust_pilot = data.frame(theta_robust_pilot)
theta_robust_pilot$method = "pilot (all summs)"
colnames(theta_robust_pilot) = c("a", "b", "g", "k", "method")
load("results_robust2.RData")
theta_robust2 = 10/(1+exp(-results$theta))
theta_robust2 = data.frame(theta_robust2)
theta_robust2$method = "summ 2"
colnames(theta_robust2) = c("a", "b", "g", "k", "method")
load("results_robust2_continue.RData")
theta_robust2_continue = 10/(1+exp(-results$theta))
theta_robust2_continue = data.frame(theta_robust2_continue)
theta_robust2_continue$method = "pilot + summ 2"
colnames(theta_robust2_continue) = c("a", "b", "g", "k", "method")
theta = rbind(theta_robust,theta_robust2,theta_robust_pilot,theta_robust2_continue)
p2 = ggplot(data=theta) +
geom_density(aes(x=b, group = method, colour = method, linetype = method), size = 1.5) +
theme(legend.position="none") +
geom_point(aes(x=true_param[2], y=0), colour="black", size = 4) +
xlim(c(0.5,1.5)) + theme(axis.title=element_text(size=16)) + labs(y= "density")
##################### parameter 3 #####################
load("results_robust.RData")
theta_robust = 10/(1+exp(-results$theta))
theta_robust = data.frame(theta_robust)
theta_robust$method = "all summs"
colnames(theta_robust) = c("a", "b", "g", "k", "method")
load("results_robust_pilot.RData")
theta_robust_pilot = 10/(1+exp(-results$theta))
theta_robust_pilot = data.frame(theta_robust_pilot)
theta_robust_pilot$method = "pilot (all summs)"
colnames(theta_robust_pilot) = c("a", "b", "g", "k", "method")
load("results_robust3.RData")
theta_robust3 = 10/(1+exp(-results$theta))
theta_robust3 = data.frame(theta_robust3)
theta_robust3$method = "summ 3"
colnames(theta_robust3) = c("a", "b", "g", "k", "method")
load("results_robust3_continue.RData")
theta_robust3_continue = 10/(1+exp(-results$theta))
theta_robust3_continue = data.frame(theta_robust3_continue)
theta_robust3_continue$method = "pilot + summ 3"
colnames(theta_robust3_continue) = c("a", "b", "g", "k", "method")
theta = rbind(theta_robust,theta_robust3,theta_robust_pilot,theta_robust3_continue)
p3 = ggplot(data=theta) +
geom_density(aes(x=g, group = method, colour = method, linetype = method), size = 1.5) +
theme(legend.position="none") +
geom_point(aes(x=true_param[3], y=0), colour="black", size = 4) +
xlim(c(1,3)) + theme(axis.title=element_text(size=16)) + labs(y= "density")
##################### parameter 4 #####################
load("results_robust.RData")
theta_robust = 10/(1+exp(-results$theta))
theta_robust = data.frame(theta_robust)
theta_robust$method = "all summs"
colnames(theta_robust) = c("a", "b", "g", "k", "method")
load("results_robust_pilot.RData")
theta_robust_pilot = 10/(1+exp(-results$theta))
theta_robust_pilot = data.frame(theta_robust_pilot)
theta_robust_pilot$method = "pilot (all summs)"
colnames(theta_robust_pilot) = c("a", "b", "g", "k", "method")
load("results_robust4.RData")
theta_robust4 = 10/(1+exp(-results$theta))
theta_robust4 = data.frame(theta_robust4)
theta_robust4$method = "summ"
colnames(theta_robust4) = c("a", "b", "g", "k", "method")
load("results_robust4_continue.RData")
theta_robust4_continue = 10/(1+exp(-results$theta))
theta_robust4_continue = data.frame(theta_robust4_continue)
theta_robust4_continue$method = "pilot + summ"
colnames(theta_robust4_continue) = c("a", "b", "g", "k", "method")
theta = rbind(theta_robust,theta_robust4,theta_robust_pilot,theta_robust4_continue)
p4 = ggplot(data=theta) +
geom_density(aes(x=k, group = method, colour = method, linetype = method), size = 1.5) +
theme(legend.position = c(0.8, 0.8)) +
theme(legend.title=element_blank()) +
geom_point(aes(x=true_param[4], y=0), colour="black", size = 4) +
xlim(c(0.25,0.75)) + theme(axis.title=element_text(size=16)) + labs(y= "density")
x11()
grid.arrange(p1, p2, p3, p4, nrow = 1)
################## s1 ##############
load("results_robust.RData")
ssx = results$ssx[,1]
ssx = data.frame(ssx)
ssx$method = "all summs"
colnames(ssx) = c("s1", "method")
load("results_robust_pilot.RData")
ssx_pilot = results$ssx[,1]
ssx_pilot = data.frame(ssx_pilot)
ssx_pilot$method = "pilot (all summs)"
colnames(ssx_pilot) = c("s1", "method")
load("results_robust1.RData")
ssx1 = results$ssx
ssx1 = data.frame(ssx1)
ssx1$method = "summ 1"
colnames(ssx1) = c("s1", "method")
load("results_robust1_continue.RData")
ssx1_continue = results$ssx
ssx1_continue = data.frame(ssx1_continue)
ssx1_continue$method = "pilot + summ 1"
colnames(ssx1_continue) = c("s1", "method")
ssx_results = rbind(ssx,ssx_pilot,ssx1,ssx1_continue)
p1 = ggplot(data=ssx_results) +
geom_density(aes(x=s1, group = method, colour = method, linetype = method), size = 1.5) +
theme(legend.position="none") +
geom_point(aes(x=obs_summ[1], y=0), colour="black", size = 4) +
xlim(c(2.97,3.02)) + theme(axis.title=element_text(size=16)) + labs(y= "density")
################## s2 ##############
load("results_robust.RData")
ssx = results$ssx[,2]
ssx = data.frame(ssx)
ssx$method = "all summs"
colnames(ssx) = c("s2", "method")
load("results_robust_pilot.RData")
ssx_pilot = results$ssx[,2]
ssx_pilot = data.frame(ssx_pilot)
ssx_pilot$method = "pilot (all summs)"
colnames(ssx_pilot) = c("s2", "method")
load("results_robust2.RData")
ssx2 = results$ssx
ssx2 = data.frame(ssx2)
ssx2$method = "summ 2"
colnames(ssx2) = c("s2", "method")
load("results_robust2_continue.RData")
ssx2_continue = results$ssx
ssx2_continue = data.frame(ssx2_continue)
ssx2_continue$method = "pilot + summ 2"
colnames(ssx2_continue) = c("s2", "method")
ssx_results = rbind(ssx,ssx_pilot,ssx2,ssx2_continue)
p2 = ggplot(data=ssx_results) +
geom_density(aes(x=s2, group = method, colour = method, linetype = method), size = 1.5) +
theme(legend.position="none") +
geom_point(aes(x=obs_summ[2], y=0), colour="black", size = 4) +
xlim(c(1.64,1.68)) + theme(axis.title=element_text(size=16)) + labs(y= "density")
################## s3 ##############
load("results_robust.RData")
ssx = results$ssx[,3]
ssx = data.frame(ssx)
ssx$method = "all summs"
colnames(ssx) = c("s3", "method")
load("results_robust_pilot.RData")
ssx_pilot = results$ssx[,3]
ssx_pilot = data.frame(ssx_pilot)
ssx_pilot$method = "pilot (all summs)"
colnames(ssx_pilot) = c("s3", "method")
load("results_robust3.RData")
ssx3 = results$ssx
ssx3 = data.frame(ssx3)
ssx3$method = "summ 3"
colnames(ssx3) = c("s3", "method")
load("results_robust3_continue.RData")
ssx3_continue = results$ssx
ssx3_continue = data.frame(ssx3_continue)
ssx3_continue$method = "pilot + summ 3"
colnames(ssx3_continue) = c("s3", "method")
ssx_results = rbind(ssx,ssx_pilot,ssx3,ssx3_continue)
p3 = ggplot(data=ssx_results) +
geom_density(aes(x=s3, group = method, colour = method, linetype = method), size = 1.5) +
theme(legend.position="none") +
geom_point(aes(x=obs_summ[3], y=0), colour="black", size = 4) +
xlim(c(0.46,0.50)) + theme(axis.title=element_text(size=16)) + labs(y= "density")
################## s4 ##############
load("results_robust.RData")
ssx = results$ssx[,4]
ssx = data.frame(ssx)
ssx$method = "all summs"
colnames(ssx) = c("s4", "method")
load("results_robust_pilot.RData")
ssx_pilot = results$ssx[,4]
ssx_pilot = data.frame(ssx_pilot)
ssx_pilot$method = "pilot (all summs)"
colnames(ssx_pilot) = c("s4", "method")
load("results_robust4.RData")
ssx4 = results$ssx
ssx4 = data.frame(ssx4)
ssx4$method = "summ"
colnames(ssx4) = c("s4", "method")
load("results_robust4_continue.RData")
ssx4_continue = results$ssx
ssx4_continue = data.frame(ssx4_continue)
ssx4_continue$method = "pilot + summ"
colnames(ssx4_continue) = c("s4", "method")
ssx_results = rbind(ssx,ssx_pilot,ssx4,ssx4_continue)
p4 = ggplot(data=ssx_results) +
geom_density(aes(x=s4, group = method, colour = method, linetype = method), size = 1.5) +
theme(legend.position = c(0.3, 0.85)) +
theme(legend.title=element_blank()) +
geom_point(aes(x=obs_summ[4], y=0), colour="black", size = 4) +
xlim(c(1.72,1.77)) + theme(axis.title=element_text(size=16)) + labs(y= "density")
x11()
grid.arrange(p1, p2, p3, p4, nrow = 1)
